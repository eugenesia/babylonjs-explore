<!DOCTYPE html>
<head>
  <title>Babylon - Explore</title>
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babylonjs/2.5.0/babylon.js"></script>
</head>
<body>

<canvas id="renderCanvas"></canvas>
<script>
  'use strict';

  var canvas = document.getElementById('renderCanvas');
  var engine = new BABYLON.Engine(canvas, true);

  // Keep code compatible with Babylon.js Playground by using createScene()
  // function.
  var createScene = function () {
    var scene = new BABYLON.Scene(engine);

    // Scene background color to green.
    scene.clearColor = new BABYLON.Color3(0, 1, 0);

    // Gravity is downwards (negative Y).
    scene.gravity = new BABYLON.Vector3(0, -9.81, 0);

    // Turn on collisions for enabled things in scene.
    scene.collisionsEnabled = true;


    var camera = new BABYLON.FreeCamera('camera1', new BABYLON.Vector3(0, 5, -10), scene);
    // var camera = new BABYLON.VRDeviceOrientationFreeCamera('camera1',
    //   new BABYLON.Vector3(0, 5, -10), scene);

    camera.setTarget(BABYLON.Vector3.Zero());

    // Attach camera to canvas.
    camera.attachControl(canvas, false);

    // Don't allow player/camera to pass thru solid things.
    camera.checkCollisions = true;
    camera.applyGravity = true;

    // Camera's (player's) collider ellipse.
    camera.ellipsoid  = new BABYLON.Vector3(1, 1, 1);


    // Light points to the sky.
    var light = new BABYLON.HemisphericLight('light1', new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = 0.5;


    // Let's try our built-in 'sphere' shape. Params: name, subdivisions, size, scene
    var sphere = BABYLON.Mesh.CreateSphere('sphere1', 16, 2, scene);

    // Move sphere upwared 1/2 its height.
    sphere.position.y = 1;

    // Allow player to push against sphere.
    sphere.checkCollisions = true;


    // Let's try our built-in 'sphere' shape. Params: name, subdivisions, size, scene.
    var ground = BABYLON.Mesh.CreateGround('ground1', 100, 100, 2, scene);

    // Make ground collidable so things won't fall thru it.
    ground.checkCollisions = true;

    // Define a grass material for the ground.
    var materialGrass = new BABYLON.StandardMaterial('grass', scene);
    materialGrass.diffuseTexture = new BABYLON.Texture('assets/textures/green_grass.jpg', scene);
    ground.material = materialGrass;


    // Group all the sub-meshes of the theatre into a parent to manage them easily.
    var theatreParent = new BABYLON.Mesh.CreateBox('theatreParent', 1, scene);
    theatreParent.scaling = new BABYLON.Vector3(0.5, 0.5, 0.5);
    theatreParent.position = new BABYLON.Vector3(0, 10, 0);

    BABYLON.SceneLoader.ImportMesh('', 'assets/models/',
      'theatre.babylon', scene,
      function (newMeshes) {
        console.log('New meshes: %O', newMeshes);
        for (var i = 0; i < newMeshes.length; i++) {
          newMeshes[i].parent = theatreParent;
        }
      });

    return scene;
  };

  var scene = createScene();

  // Register a render loop to repeatedly render the scene.
  engine.runRenderLoop(function () {
    scene.render();
  });

  // Watch for browser/canvas resize events
  window.addEventListener("resize", function () {
    engine.resize();
  });

</script>
</body>
</html>

